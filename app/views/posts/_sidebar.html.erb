<div class="container mx-auto px-4 py-8 max-w-4xl">
  <div class="mt-8 space-y-6">
    <div class="bg-white rounded-xl shadow-lg overflow-hidden border-4 border-indigo-400">
      <div class="bg-gradient-to-r from-indigo-600 to-purple-600 p-6">
        <h2 class="text-white text-3xl font-bold tracking-tight">Start Your Learning Journey</h2>
      </div>
      <div class="p-6 bg-gradient-to-b from-indigo-50 to-white">
        <% if user_signed_in? %>
          <% if @completed_lessons&.any? %>
            <% if @completed_lessons.count == @post.lessons.count %>
              <p class="text-indigo-900 text-xl mb-4 font-semibold">ðŸŽ‰ Congratulations! You've mastered this course.</p>
              <%= link_to "Review Course", post_lesson_path(@post, @post.first_lesson), class: "btn-primary" if @post.first_lesson %>
            <% else %>
              <p class="text-indigo-900 text-xl mb-4 font-semibold">ðŸ“š Your progress is impressive! Keep going!</p>
              <%= link_to "Resume Course", post_lesson_path(@post, @post.next_lesson(current_user)), class: "btn-primary" %>
            <% end %>
          <% else %>
            <p class="text-indigo-900 text-xl mb-4 font-semibold">ðŸš€ Embark on an exciting web development adventure!</p>
            <%= link_to "Start Course", post_lesson_path(@post, @post.first_lesson), class: "btn-primary" if @post.first_lesson %>
          <% end %>
        <% else %>
          <p class="text-indigo-900 text-xl mb-4 font-semibold">ðŸŒŸ Unlock a world of knowledge with our free sign-up!</p>
          <%= link_to "Sign Up", new_user_registration_path, class: "btn-primary" %>
        <% end %>
      </div>
    </div>

    <% if user_signed_in? %>
      <% unless current_user.ratings.exists?(post: @post) %>
        <%= form_for [@post, Rating.new], html: { class: "rating-form mb-4" } do |f| %>
          <div class="rating-stars">
            <% 5.downto(1) do |i| %>
              <input type="radio" name="rating[score]" value="<%= i %>" id="rating_<%= i %>" class="hidden" />
              <label for="rating_<%= i %>" class="star">â˜…</label>
            <% end %>
          </div>
          <%= f.submit "Rate Course", class: "rating-submit" %>
        <% end %>
      <% end %>

      <% if @post.unlock_count&.positive? %>
        <div class="text-sm text-gray-500 mb-2">
          <%= @post.unlock_count %> students enrolled
        </div>
      <% end %>

      <% if @post.paid_for_course == false %>
        <%= button_to "Unlock Course", 
            post_unlocks_path(@post), 
            method: :post, 
            class: "w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded transition duration-200" %>
      <% end %>
    <% end %>
  </div>
</div>

<style>
  .btn-primary {
    background-color: #4f46e5;
    color: white;
    font-weight: bold;
    padding: 1rem 1.5rem;
    border-radius: 0.75rem;
    text-align: center;
    width: 100%;
    transition: background-color 0.3s ease, transform 0.2s ease;
  }

  .btn-primary:hover {
    background-color: #4338ca;
    transform: scale(1.05);
  }

  .rating-stars {
    display: flex;
    justify-content: center;
    gap: 0.5rem;
  }

  .rating-stars input[type="radio"] {
    display: none;
  }

  .rating-stars label {
    font-size: 2rem;
    color: #d1d5db;
    cursor: pointer;
    transition: color 0.3s ease;
  }

  .rating-stars input[type="radio"]:checked + label,
  .rating-stars label:hover,
  .rating-stars label:hover ~ label {
    color: #fbbf24; /* Yellow */
  }

  .rating-submit {
    display: block;
    width: 100%;
    background-color: #3b82f6;
    color: white;
    padding: 0.5rem 1rem;
    font-size: 1rem;
    border: none;
    border-radius: 0.375rem;
    text-align: center;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  .rating-submit:hover {
    background-color: #2563eb;
  }
</style>
